import './NavBar.css';
import React, { useEffect, useState } from "react";
import { Link } from "react-router-dom";

const Navbar = () => {
    const [click, setClick] = useState(false);
    const [isLoggedIn, setIsLoggedIn] = useState(false);
    const [username, setUsername] = useState("");
    // const [email, setEmail] = useState("");
    // const [showDropdown, setShowDropdown] = useState(false);

    const handleClick = () => setClick(!click);

    const handleLogout = () => {
        sessionStorage.removeItem("auth-token");
        sessionStorage.removeItem("name");
        sessionStorage.removeItem("email");
        sessionStorage.removeItem("phone");
        // remove email phone
        localStorage.removeItem("doctorData");
        setIsLoggedIn(false);
        // setUsername("");

        // Remove the reviewFormData from local storage
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            if (key.startsWith("reviewFormData_")) {
                localStorage.removeItem(key);
            }
        }
        // setEmail('');
        window.location.reload();
    }

    // const handleDropdown = () => {
    //     setShowDropdown(!showDropdown);
    // }
    useEffect(() => {
        const name = sessionStorage.getItem("name");

        if (name) {
            setIsLoggedIn(true);
            setUsername(name);
        }
    }, []);

    return (
        <div className='nav'>
            <div>
                <Link to="/">
                    <svg width="241" height="53" viewBox="0 0 241 53" fill="none">
                        <path d="M9.92 37.384C8.29867 37.384 6.848 37.1067 5.568 36.552C4.30933 35.9973 3.30667 35.1867 2.56 34.12C1.83467 33.0533 1.46133 31.7627 1.44 30.248H6.016C6.03733 30.9093 6.208 31.5067 6.528 32.04C6.848 32.5733 7.28533 33 7.84 33.32C8.416 33.6187 9.09867 33.768 9.888 33.768C10.5707 33.768 11.1573 33.6613 11.648 33.448C12.16 33.2133 12.5547 32.8933 12.832 32.488C13.1093 32.0827 13.248 31.6027 13.248 31.048C13.248 30.408 13.088 29.8747 12.768 29.448C12.4693 29.0213 12.0427 28.6587 11.488 28.36C10.9547 28.0613 10.3253 27.7947 9.6 27.56C8.896 27.304 8.14933 27.0373 7.36 26.76C5.58933 26.184 4.23467 25.416 3.296 24.456C2.37867 23.496 1.92 22.2267 1.92 20.648C1.92 19.304 2.24 18.152 2.88 17.192C3.54133 16.232 4.448 15.496 5.6 14.984C6.752 14.472 8.064 14.216 9.536 14.216C11.0507 14.216 12.3733 14.4827 13.504 15.016C14.656 15.528 15.5627 16.2747 16.224 17.256C16.9067 18.2373 17.2587 19.3893 17.28 20.712H12.672C12.6507 20.2213 12.5013 19.7627 12.224 19.336C11.968 18.888 11.6053 18.536 11.136 18.28C10.6667 18.0027 10.112 17.864 9.472 17.864C8.91733 17.8427 8.40533 17.928 7.936 18.12C7.488 18.312 7.12533 18.6 6.848 18.984C6.592 19.3467 6.464 19.8053 6.464 20.36C6.464 20.8933 6.592 21.3413 6.848 21.704C7.12533 22.0667 7.49867 22.3867 7.968 22.664C8.43733 22.92 8.992 23.1653 9.632 23.4C10.272 23.6133 10.9653 23.8373 11.712 24.072C12.8213 24.456 13.8453 24.9147 14.784 25.448C15.7227 25.96 16.4693 26.632 17.024 27.464C17.5787 28.296 17.856 29.3947 17.856 30.76C17.856 31.9333 17.5467 33.0213 16.928 34.024C16.3093 35.0267 15.4133 35.8373 14.24 36.456C13.088 37.0747 11.648 37.384 9.92 37.384ZM28.6885 37C27.5578 37 26.5658 36.8293 25.7125 36.488C24.8805 36.1253 24.2298 35.5387 23.7605 34.728C23.2912 33.896 23.0565 32.7653 23.0565 31.336V24.488H20.3045V20.872H23.0565L23.5365 16.488H27.3765V20.872H31.6325V24.488H27.3765V31.4C27.3765 32.1253 27.5365 32.6267 27.8565 32.904C28.1765 33.1813 28.7205 33.32 29.4885 33.32H31.6005V37H28.6885ZM40.7083 37.384C39.3643 37.384 38.2549 37.1707 37.3802 36.744C36.5056 36.296 35.8549 35.7093 35.4283 34.984C35.0229 34.2373 34.8203 33.416 34.8203 32.52C34.8203 31.5387 35.0656 30.6747 35.5563 29.928C36.0683 29.1813 36.8256 28.5947 37.8283 28.168C38.8523 27.7413 40.1323 27.528 41.6683 27.528H45.6683C45.6683 26.7387 45.5616 26.088 45.3483 25.576C45.1349 25.0427 44.8043 24.648 44.3563 24.392C43.9083 24.136 43.3109 24.008 42.5642 24.008C41.7536 24.008 41.0603 24.1893 40.4843 24.552C39.9296 24.8933 39.5883 25.4267 39.4603 26.152H35.2682C35.3749 25 35.7483 24.008 36.3883 23.176C37.0496 22.3227 37.9136 21.6613 38.9803 21.192C40.0683 20.7227 41.2736 20.488 42.5963 20.488C44.1109 20.488 45.4229 20.744 46.5323 21.256C47.6416 21.768 48.4949 22.504 49.0923 23.464C49.6896 24.424 49.9883 25.608 49.9883 27.016V37H46.3403L45.8603 34.536C45.6256 34.9627 45.3483 35.3467 45.0283 35.688C44.7083 36.0293 44.3349 36.328 43.9083 36.584C43.4816 36.84 43.0016 37.032 42.4683 37.16C41.9349 37.3093 41.3483 37.384 40.7083 37.384ZM41.7323 34.056C42.2869 34.056 42.7776 33.96 43.2043 33.768C43.6523 33.5547 44.0363 33.2773 44.3563 32.936C44.6763 32.5733 44.9216 32.168 45.0923 31.72C45.2843 31.2507 45.4123 30.7493 45.4763 30.216V30.184H42.1803C41.5189 30.184 40.9749 30.2693 40.5483 30.44C40.1429 30.5893 39.8443 30.8133 39.6523 31.112C39.4603 31.4107 39.3643 31.752 39.3643 32.136C39.3643 32.5627 39.4603 32.9147 39.6523 33.192C39.8443 33.4693 40.1216 33.6827 40.4843 33.832C40.8469 33.9813 41.2629 34.056 41.7323 34.056ZM55.5038 44.04L59.4078 35.208H58.4478L51.9838 20.872H56.6878L61.2958 31.272L65.4558 20.872H70.0318L60.0798 44.04H55.5038ZM86.9763 37V14.6H91.2963V37H86.9763ZM72.8643 37V14.6H77.1843V37H72.8643ZM76.5763 27.304V23.816H87.7123V27.304H76.5763ZM103.356 37.384C101.735 37.384 100.295 37.0427 99.036 36.36C97.7987 35.656 96.828 34.6853 96.124 33.448C95.4413 32.1893 95.1 30.7387 95.1 29.096C95.1 27.4107 95.4413 25.928 96.124 24.648C96.828 23.3467 97.7987 22.3333 99.036 21.608C100.273 20.8613 101.713 20.488 103.356 20.488C104.956 20.488 106.353 20.84 107.548 21.544C108.743 22.248 109.671 23.1973 110.332 24.392C110.993 25.5867 111.324 26.9413 111.324 28.456C111.324 28.6693 111.324 28.9147 111.324 29.192C111.324 29.448 111.303 29.7147 111.26 29.992H98.172V27.368H106.972C106.908 26.3227 106.535 25.5013 105.852 24.904C105.191 24.3067 104.359 24.008 103.356 24.008C102.631 24.008 101.959 24.1787 101.34 24.52C100.721 24.84 100.231 25.3413 99.868 26.024C99.5267 26.7067 99.356 27.5707 99.356 28.616V29.544C99.356 30.4187 99.516 31.1867 99.836 31.848C100.177 32.488 100.647 32.9893 101.244 33.352C101.841 33.6933 102.535 33.864 103.324 33.864C104.113 33.864 104.764 33.6933 105.276 33.352C105.809 33.0107 106.204 32.5733 106.46 32.04H110.876C110.577 33.0427 110.076 33.9493 109.372 34.76C108.668 35.5707 107.804 36.2107 106.78 36.68C105.756 37.1493 104.615 37.384 103.356 37.384ZM120.302 37.384C118.958 37.384 117.849 37.1707 116.974 36.744C116.099 36.296 115.449 35.7093 115.022 34.984C114.617 34.2373 114.414 33.416 114.414 32.52C114.414 31.5387 114.659 30.6747 115.15 29.928C115.662 29.1813 116.419 28.5947 117.422 28.168C118.446 27.7413 119.726 27.528 121.262 27.528H125.262C125.262 26.7387 125.155 26.088 124.942 25.576C124.729 25.0427 124.398 24.648 123.95 24.392C123.502 24.136 122.905 24.008 122.158 24.008C121.347 24.008 120.654 24.1893 120.078 24.552C119.523 24.8933 119.182 25.4267 119.054 26.152H114.862C114.969 25 115.342 24.008 115.982 23.176C116.643 22.3227 117.507 21.6613 118.574 21.192C119.662 20.7227 120.867 20.488 122.19 20.488C123.705 20.488 125.017 20.744 126.126 21.256C127.235 21.768 128.089 22.504 128.686 23.464C129.283 24.424 129.582 25.608 129.582 27.016V37H125.934L125.454 34.536C125.219 34.9627 124.942 35.3467 124.622 35.688C124.302 36.0293 123.929 36.328 123.502 36.584C123.075 36.84 122.595 37.032 122.062 37.16C121.529 37.3093 120.942 37.384 120.302 37.384ZM121.326 34.056C121.881 34.056 122.371 33.96 122.798 33.768C123.246 33.5547 123.63 33.2773 123.95 32.936C124.27 32.5733 124.515 32.168 124.686 31.72C124.878 31.2507 125.006 30.7493 125.07 30.216V30.184H121.774C121.113 30.184 120.569 30.2693 120.142 30.44C119.737 30.5893 119.438 30.8133 119.246 31.112C119.054 31.4107 118.958 31.752 118.958 32.136C118.958 32.5627 119.054 32.9147 119.246 33.192C119.438 33.4693 119.715 33.6827 120.078 33.832C120.441 33.9813 120.857 34.056 121.326 34.056ZM133.612 37V13.96H137.932V37H133.612ZM149.407 37C148.277 37 147.285 36.8293 146.431 36.488C145.599 36.1253 144.949 35.5387 144.479 34.728C144.01 33.896 143.775 32.7653 143.775 31.336V24.488H141.023V20.872H143.775L144.255 16.488H148.095V20.872H152.351V24.488H148.095V31.4C148.095 32.1253 148.255 32.6267 148.575 32.904C148.895 33.1813 149.439 33.32 150.207 33.32H152.319V37H149.407ZM155.987 37V13.96H160.307V23.272C160.84 22.4187 161.544 21.7467 162.419 21.256C163.315 20.744 164.35 20.488 165.523 20.488C166.867 20.488 167.998 20.776 168.915 21.352C169.832 21.9067 170.526 22.7173 170.995 23.784C171.464 24.8507 171.699 26.1733 171.699 27.752V37H167.411V28.136C167.411 26.856 167.144 25.8747 166.611 25.192C166.078 24.488 165.235 24.136 164.083 24.136C163.379 24.136 162.739 24.3067 162.163 24.648C161.587 24.9893 161.128 25.4907 160.787 26.152C160.467 26.792 160.307 27.56 160.307 28.456V37H155.987ZM177.254 44.04L181.158 35.208H180.198L173.734 20.872H178.438L183.046 31.272L187.206 20.872H191.782L181.83 44.04H177.254Z" fill="black" />
                        <rect x="201" y="7" width="40" height="40" fill="url(#pattern0_11_514)" />
                        <defs>
                            <pattern id="pattern0_11_514" patternContentUnits="objectBoundingBox" width="1" height="1">
                                <use transform="scale(0.00195312)" />
                            </pattern>
                            <image id="image0_11_514" width="512" height="512" preserveAspectRatio="none"></image>
                        </defs>
                    </svg>
                </Link>
            </div>

            <div className="nav__icon" onClick={handleClick}>
                <i className={click ? "fa fa-times" : "fa fa-bars"}></i>
            </div>


            <ul className={click ? 'nav__links active' : 'nav__links'}>
                <li className="link">
                    <Link to='/'>
                        Home
                    </Link>
                </li>

                <li className="link">
                    Appointments
                </li>
                <li className="link">
                    Health Blog
                </li>
                <li className="link">
                    Reviews
                </li>

                {isLoggedIn ? (
                    <>
                        <li className="link gap">
                            <div className='underline'>Welcome, <span className='orangeText'>{username}</span></div>
                            <button className="btn1" onClick={handleLogout}>
                                Logout
                            </button>
                        </li>

                    </>
                ) : (
                    <>
                        <li className="link">
                            <Link to="/signup">
                                <button className="btn1">Sign Up</button>
                            </Link>
                        </li>
                        <li className="link">
                            <Link to="/login">
                                <button className="btn1">Login</button>
                            </Link>
                        </li>
                    </>
                )}
            </ul>
        </div>
    )
}

export default Navbar;